ggplot() +
geom_jitter(aes(y=MeanAmplitudeOfPositives,x=Species,shape = assay),size=2,color="forestgreen")+
geom_boxplot(aes(x = Species, y = MeanAmplitudeOfPositives),fill="forestgreen",
alpha=0.5)+
geom_jitter(aes(y=MeanAmplitudeOfNegatives,x=Species,shape = assay),size=2,color="tomato2")+
geom_boxplot(aes(x = Species, y = MeanAmplitudeOfNegatives),fill="tomato2",
alpha=0.5)+
theme_bw()+
scale_shape_manual(values = c(17, 19)) +
labs(x = "Species",
y = "Mean amplitude of droplets")+
theme(legend.position = "none",
strip.background = element_blank(),
strip.text.x = element_blank(),
axis.title.y = element_text(size = 22),
axis.title.x = element_text(size = 22),
plot.margin = margin(0.1, 0.1, 0.5, 0.5, "cm"),
axis.text.x = element_text(size=18),
axis.text.y=element_text(size=16))
p1_leg <-
ggplot() +
geom_point(aes(x = NA, y = NA, color = "Positive droplet"), size = 1) +
geom_point(aes(x = NA, y = NA, color = "Negative droplet"), size = 1) +
theme_bw()+
scale_color_manual(
name='Detection',
breaks=c("Positive droplet", "Negative droplet"),
values = c("forestgreen", "tomato2"),
guide = guide_legend(
override.aes = list(lty = c(1,1),
size = c(2,2)))) +
theme(plot.margin = margin(1, 4, 1, 0, "cm"),
legend.key.width = unit(1.2,"cm"),
legend.title = element_text(size=18),
legend.key.height = unit(0.8, 'cm'),
legend.text = element_text(size=16))
p2_leg <-
ggplot() +
geom_point(aes(x = NA, y = NA, color = "Cod + herring"), size = 1) +
geom_point(aes(x = NA, y = NA, color = "Cod + saithe"), size = 1) +
theme_bw()+
scale_color_manual(
name="Assay",
breaks=c("Cod + herring", "Cod + saithe"),
values = c("black", "black"),
guide = guide_legend(
override.aes = list(shape = c(17,19),
size = c(2,2)))) +
theme(plot.margin = margin(1, 4, 1, 0, "cm"),
legend.key.width = unit(1.2,"cm"),
legend.title = element_text(size=18),
legend.key.height = unit(0.8, 'cm'),
legend.text = element_text(size=16))
p1_leg_leg <- cowplot::get_legend(p1_leg+
theme(legend.justification = c(0,0.0)))
p2_leg_leg <- cowplot::get_legend(p2_leg+
theme(legend.justification = c(0,1.0)))
legend <- cowplot::plot_grid(p1_leg_leg,p2_leg_leg,nrow = 2)
Figure_S4 <- cowplot::plot_grid(pp1,legend,ncol = 2, rel_widths = c(4,1))
Figure_S4
# Load libraries and data -----------------------------------------------------------
rm(list=ls())
library(ggplot2)
library(dplyr)
library(rstan)
load("/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Writing/Submitting papers/Manuscript 4/Code and data/All_data_for_reviewers.RData")
stanMod_M1@model_name
stanMod_M1@model_name <- "Sensitivity model"
stanMod_M2@model_name
stanMod_M3@model_name
stanMod_M3@model_name <- "qPCR two-step model"
stanMod_M2@model_name
stanMod_M2@model_name <- "Quantification precision model"
stanMod_M1@stan_args
stanMod_M1
# Figure S3 - Possion statistics between assays ------------------------------------
kappa_0 <- extract_param(stanMod_M2,"kappa_0") %>%
cbind(.,e_ddpcr %>%
filter(!duplicated(species_idx)) %>%
arrange(species_idx) %>%
select(Species,species_idx))
kappa_1 <- extract_param(stanMod_M2,"kappa_1") %>%
cbind(.,e_ddpcr %>%
filter(!duplicated(species_idx)) %>%
arrange(species_idx) %>%
select(Species,species_idx))
conc_st <- -2
conc_end <- 5
repl <- rep(seq(conc_st,conc_end,by=0.1),3)
logist_diff <-
repl %>% as.data.frame() %>%
cbind(.,kappa_0 %>% pull(mean) %>% rep(.,each=length(repl)/3)) %>%
cbind(.,kappa_1 %>% pull(mean) %>% rep(.,each=length(repl)/3)) %>%
cbind(.,kappa_0 %>% pull(Species) %>% rep(.,each=length(repl)/3)) %>%
setNames(c("C","intercept","slope","Species")) %>%
mutate(omega=intercept+(slope*C))
sim <- seq(-2,4.9,by=0.1) %>% as.data.frame() %>% setNames("C") %>%
mutate(omega=inv.cloglog(-7.07+(2.3*C)))
pp1 <-
logist_diff %>%
ggplot()+
geom_line(aes(y=inv.cloglog(omega),x=10^C,color=Species),lwd=1)+
geom_line(data=sim,aes(y=(omega),x=10^C),color="black",lty=2,lwd=0.3)+
# scale_x_log10(labels=scientific_10)+ #
scale_x_log10(labels=scientific_10,breaks=c(10^seq(conc_st,conc_end)))+ #
scale_y_sqrt()+
# scale_y_continuous(breaks=seq(-2.5,-1,by=0.2))+
scale_color_manual(values=c("tomato2", "deepskyblue2","orange2"))+
# geom_abline(intercept = 0,slope=1,lty=2)+
theme_bw()+
# facet_grid(~Species)+
theme(legend.position = "none",
strip.background = element_blank(),
strip.text.x = element_blank(),
axis.title.y = element_text(size = 19),
plot.margin = margin(0.1, 0.1, 0.5, 0.5, "cm"),
axis.title.x = element_text(size = 19),
axis.text.x = element_text(size=14),
axis.text.y=element_text(size=14))+
ylab(expression("Proportion of positive droplets"))+
xlab("Nominal concentration (copies/ÂµL)")
pp1
setwd("/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Data/Trawl data/")
library(readxl)
list.files()
dataset <- read_excel("/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Data/Trawl data/Catch weight nmds data w_metadata.xlsx")
View(dataset)
library(readxl)
dataset <- read_excel("/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Data/Trawl data/Catch weight nmds data w_metadata.xlsx")
View(dataset)
dataset <- read_excel("/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Data/Trawl data/Catch weight nmds data w_metadata.xlsx",header=T)
dataset <- read_excel("/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Data/Trawl data/Catch weight nmds data w_metadata.xlsx")
biomass <- read_excel("/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Data/Trawl data/Catch weight nmds data w_metadata.xlsx")
biomass
biomass[-2,]
biomass[-1,]
biomass <- biomass[-1,]
biomass
library(dplyr)
biomass <- biomass %>% mutate_at(`2018...2`,as.numeric())
rep(2018,each=4)
rep(c(2018,2019,2020),each=4)
rep(c("A","B","C","D"))
rep(c("A","B","C","D"),4)
paste0(rep(c(2018,2019,2020),each=4),"_",rep(c("A","B","C","D"),4))
biomass <- biomass[-1,] %>% setNames(.,paste0(rep(c(2018,2019,2020),each=4),"_",rep(c("A","B","C","D"),4)))
biomass
library(readxl)
library(dplyr)
biomass <- read_excel("/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Data/Trawl data/Catch weight nmds data w_metadata.xlsx")
biomass <- biomass[-1,] %>% setNames(.,paste0(rep(c(2018,2019,2020),each=4),"_",rep(c("A","B","C","D"),4)))
biomass <- read_excel("/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Data/Trawl data/Catch weight nmds data w_metadata.xlsx") %>%
setNames(.,paste0(rep(c(2018,2019,2020),each=4),"_",rep(c("A","B","C","D"),4)))
biomass
biomass <- biomass[-1,]
biomass
biomass <- biomass %>% mutate_at(`2018_B`,as.numeric())
biomass %>% mutate_at(2018_B,as.numeric())
biomass <- read_excel("/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Data/Trawl data/Catch weight nmds data w_metadata.xlsx") %>%
setNames(.,paste0(rep(c("A","B","C","D"),4)),"_",rep(c(2018,2019,2020),each=4))
biomass <- read_excel("/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Data/Trawl data/Catch weight nmds data w_metadata.xlsx") %>%
setNames(.,paste0(rep(c("A","B","C","D"),4),"_",rep(c(2018,2019,2020),each=4)))
biomass
biomass <- biomass[-1,]
biomass
biomass %>% mutate_at(B_2018,as.numeric())
biomass %>% mutate_at("B_2018",as.numeric)
biomass %>% mutate_at("B_2018",as.numeric)
paste0(rep(c("A","B","C","D"),4),"_",rep(c(2018,2019,2020),each=4))
biomass <- read_excel("/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Data/Trawl data/Catch weight nmds data w_metadata.xlsx") %>%
setNames(.,paste0(rep(c("A","B","C","D"),4),"_",rep(c(2018,2019,2020),each=4)))
biomass <- biomass[-1,]
biomass
biomass %>% mutate_at("B_2018",as.numeric)
colnames(biomass)
biomass <- read_excel("/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Data/Trawl data/Catch weight nmds data w_metadata.xlsx") %>%
setNames(.,c("Species",paste0(rep(c("A","B","C","D"),4),"_",rep(c(2018,2019,2020),each=4))))
biomass <- biomass[-1,]
biomass
biomass %>% mutate_at("B_2018",as.numeric)
biomass %>% mutate_at(c("B_2018","C_2018"),as.numeric)
biomass
biomass %>% colnames()
biomass %>% colnames() %>% select(-Species)
biomass %>% select(-Species) %>% colnames()
biomass %>% mutate_at(select(-Species) %>% colnames(),as.numeric)
biomass %>% mutate_at(biomass %>% select(-Species) %>% colnames(),as.numeric)
biomass %>% mutate_at(. %>% select(-Species) %>% colnames(),as.numeric)
biomass
biomass %>%
mutate(across(-Species, as.numeric))
biomass <- biomass %>%
mutate(across(-Species, as.numeric))
biomass
biomass %>% hist(A_2018)
hist(biomass$A_2018)
hist(biomass$A_2018,breaks=100)
biomass %>% hist("A_2018")
biomass %>% hist(as.numeric(A_2018))
library(tidyr)
library(ggplot2)
biomass %>% hist(A_2018)
biomass %>%
gather(Column, Value, -Species)
biomass %>%
gather(Column, Value, -Species) %>%
ggplot(., aes(Value)) +
geom_histogram(binwidth=30, fill="skyblue", color="black") +
facet_wrap(~ Column, scales = "free_x")
biomass %>%
gather(Column, Value, -Species) %>%
ggplot(., aes(Value)) +
geom_histogram(binwidth=30, fill="skyblue", color="black") +
facet_wrap(~ Column, scales = "free_x")+
scale_x_log10()
biomass %>%
gather(Column, Value, -Species) %>%
ggplot(., aes(Value)) +
geom_histogram(binwidth=10, fill="skyblue", color="black") +
facet_wrap(~ Column, scales = "free_x")+
scale_x_log10()
biomass %>%
gather(Column, Value, -Species) %>%
ggplot(., aes(Value)) +
geom_histogram(binwidth=0.01, fill="skyblue", color="black") +
facet_wrap(~ Column, scales = "free_x")+
scale_x_log10()
biomass %>%
gather(Column, Value, -Species) %>%
ggplot(., aes(Value)) +
geom_histogram(binwidth=0.1, fill="skyblue", color="black") +
facet_wrap(~ Column, scales = "free_x")+
scale_x_log10()
biomass %>%
gather(Column, Value, -Species) %>%
ggplot(., aes(Value)) +
geom_histogram(binwidth=0.1, fill="skyblue", color="black") +
facet_wrap(~ Column, scales = "free_x")+
scale_x_sqrt()
biomass %>%
gather(Column, Value, -Species)
biomass %>%
gather(Column, Value, -Species) %>%
ggplot(., aes(Value)) +
geom_histogram(binwidth=0.1, fill="skyblue", color="black") +
facet_wrap(~ Species, scales = "free_x")+
scale_x_sqrt()
biomass %>%
gather(Column, Value, -Species) %>%
ggplot(., aes(Value)) +
geom_histogram(binwidth=0.1, fill="skyblue", color="black") +
facet_wrap(~ Species, scales = "free_x")
biomass %>%
gather(Column, Value, -Species) %>%
ggplot(., aes(Value)) +
geom_histogram(binwidth=0.01, fill="skyblue", color="black") +
facet_wrap(~ Species, scales = "free_x")
rlnorm(10000,0,1)
hist(rlnorm(10000,0,1))
hist(rlnorm(10000,0,0.0011))
hist(rlnorm(16,0,0.001))
hist(rlnorm(16,0,0.01))
hist(rlnorm(16,1,0.01))
hist(rlnorm(16,-2,0.01))
hist(rlnorm(16,-4,0.01))
hist(rlnorm(16,-4,0.1))
hist(rlnorm(1600,-4,0.1))
hist(rlnorm(1600,-4,1))
dev.off()
biomass %>%
gather(Column, Value, -Species) %>%
ggplot(., aes(Value)) +
geom_histogram(binwidth=0.01, fill="skyblue", color="black") +
facet_wrap(~ Species, scales = "free_x")
hist(rlnorm(1600,-4,1))
biomass %>%
gather(Column, Value, -Species) %>%
ggplot(., aes(Value)) +
geom_histogram(binwidth=0.01, fill="skyblue", color="black") +
facet_wrap(~ Species, scales = "free_x")
hist(rlnorm(1600,-4,1))
hist(rlnorm(16,-4,1))
hist(rlnorm(1600,5,1))
hist(rlnorm(1600,10,1))
hist(rlnorm(1600,8,1))
hist(rlnorm(1600,8.6,1))
hist(rlnorm(1600,9.6,1))
hist(rlnorm(1600,11,1))
hist(rlnorm(1600,11,0.01))
hist(rlnorm(1600,10.5,0.01))
hist(rlnorm(1600,10.8,0.01))
hist(rlnorm(1600,10.9,0.01))
hist(rlnorm(1600,10.93,0.01))
hist(rlnorm(1600,10.92,0.01))
hist(rlnorm(1600,10.918,0.01))
biomass %>%
gather(Column, Value, -Species) %>%
ggplot(., aes(Value)) +
geom_histogram(binwidth=0.01, fill="skyblue", color="black") +
facet_wrap(~ Species, scales = "free_x")
hist(rlnorm(1600,10.918,0.001))
hist(rlnorm(1600,10.918,0.0001))
hist(rlnorm(1600,10.919,0.0001))
hist(rlnorm(1600,10.920,0.0001))
hist(rlnorm(1600,10.9195,0.0001))
hist(rlnorm(1600,10.9194,0.0001))
hist(rlnorm(16,10.9194,0.0001))
hist(rlnorm(16,10.9194,0.0005))
hist(rlnorm(16,10.9194,0.0002))
hist(rlnorm(16,10.9195,0.0002))
exp(10.9195)
library(dplyr)
library(ggu.base.fun)
library(naniar)
library(tidyr)
library(stringr)
edna_to_otu_2 <- function(edna_df){
otu <- edna_df %>% select(colnames(.)[(which(colnames(.)=="tot_reads")+1):ncol(.)])
return(otu)
}
# setwd("/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Data/Bioinformatics/Plate_NANB")
setwd("/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Data/Bioinformatics/Plate_NCND")
df <- read.csv("GG01.All_MOTUs_collapsed_blasted_filtered_collapsed.csv")
df
df2 <- read.csv("GG01.All_MOTUs_collapsed_blasted_filtered.csv")
df2
df
df2
colnames(df)
colnames(df2)
dim(df)
dim(df2)
mm <- read.csv("/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Documents & Protocolls/ALL_FISHDIV_samples_metadata_curated.csv")
mm2 <- mm %>% filter(grepl("Plate_NC",Plate)|grepl("Plate_ND",Plate))
mm2
nenf <- read.csv("/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Data/Bioinformatics/Plate_NENF/Plate_NE_All_MOTUs_collapsed.csv")
dim(nenf)
mm <- read.csv("/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Documents & Protocolls/ALL_FISHDIV_samples_metadata_curated.csv")
nenf %>% colnames()
nenf %>% colnames()[1:16]
nenf %>% colnames()
c("id","rank","scientific_name","best_identity","superkingdom_name","kingdom_name","phylum_name","class_name","order_name","family_name","genus_name","species_name","best_match","species_list","taxid")
noo <- c("id","rank","scientific_name","best_identity","superkingdom_name","kingdom_name","phylum_name","class_name","order_name","family_name","genus_name","species_name","best_match","species_list","taxid")
nenf %>% select(-noo)
nenf %>% select(-noo) %>% colnames()
noo <- c("id","rank","scientific_name","best_identity","superkingdom_name","kingdom_name","phylum_name","class_name","order_name","family_name","genus_name","species_name","best_match","species_list","taxid","seq_length","cluster_weight","total_reads","sequence")
nenf %>% select(-noo) %>% colnames()
head(mm)
mm %>% filter(paste0("X",Filter_name))
mm %>% mutate(Filter_name,paste0("X",Filter_name))
mm %>% mutate(Filter_name=paste0("X",Filter_name))
nenf %>% select(-noo) %>% colnames()
mm %>% mutate(Filter_name=paste0("X",Filter_name)) %>%
filter(Filter_name%in% nenf %>% select(-noo) %>% colnames())
mm %>% mutate(Filter_name=paste0("X",Filter_name))
nenf %>% select(-noo) %>% colnames()
mm$Filter_name %in% nenf %>% select(-noo) %>% colnames()
nenf %>% select(-noo) %>% colnames()
l <- nenf %>% select(-noo) %>% colnames()
mm$Filter_name %in% l
mm$Filter_name[mm$Filter_name %in% l]
l
View(mm)
mm %>% mutate(Filter_name=paste0("X",Filter_name))
View(mm)
mm %>% filter(Running_no>0)
mm %>% filter(!Running_no>0)
mm %>% filter(Running_no>0)
mm %>% filter(Running_no>0) %>% dim()
mm %>% dim()
mm2 <- mm %>% mutate(Filter_name=if_else(Running_no>0,paste0("X",Filter_name),Filter_name))
View(mm2)
View(mm)
mm2 <- mm %>% mutate(Filter_name=if_else(!is.na(Running_no),paste0("X",Filter_name),Filter_name))
mm <- mm %>% mutate(Filter_name=if_else(!is.na(Running_no),paste0("X",Filter_name),Filter_name))
mm
mm %>% filter(Filter_name %in% nenf %>% select(-noo) %>% colnames())
l <- nenf %>% select(-noo) %>% colnames()
l
mm %>% filter(Filter_name %in% l)
mm %>% filter(Filter_name %in% l)
mm %>% filter(Filter_name %in% l)	%>%
distinct(Station_name)
mm %>% filter(Filter_name %in% l)	%>% head()
mm %>% filter(Filter_name %in% l)	%>%
distinct(Cruise_no,Station_name)
table_data <- data.frame(
Year = c(2018, 2019, 2019, 2020, 2020, 2021, 2021, 2021, 2022, 2022),
Time = c("October", "May", "Oct", "June", "October", "March", "June", "October", "March", "September"),
Balsfjord = c(4, 4, 4, 3, 4, 10, 5, 4, 7, "x"),
Frakfjord = c(NA, NA, NA, 3, NA, 4, 3, 4, 4, 4),
Olderfjord = c(NA, NA, NA, 1, NA, 3, 1, 3, 3, 3),
Bergsfjord = c(NA, NA, NA, 6, NA, 8, 6, NA, 6, 6)
)
# View the table
print(table_data)
over <- data.frame(
Year = c(2018, 2019, 2019, 2020, 2020, 2021, 2021, 2021, 2022, 2022),
Time = c("October", "May", "Oct", "June", "October", "March", "June", "October", "March", "September"),
Balsfjord = c(4, 4, 4, 3, 4, 10, 5, 4, 7, "x"),
Frakfjord = c(NA, NA, NA, 3, NA, 4, 3, 4, 4, 4),
Olderfjord = c(NA, NA, NA, 1, NA, 3, 1, 3, 3, 3),
Bergsfjord = c(NA, NA, NA, 6, NA, 8, 6, NA, 6, 6)
)
over
over <- data.frame(
Year = c(2018, 2019, 2019, 2020, 2020, 2021, 2021, 2021, 2022, 2022),
Time = c("October", "May", "Oct", "June", "October", "March", "June", "October", "March", "September"),
Balsfjord = c(4, 4, 4, 3, 4, 10, 5, 4, 7, "x"),
Frakfjord = c(0, 0, 0, 3, 0, 4, 3, 4, 4, 4),
Olderfjord = c(0, 0, 0, 1, 0, 3, 1, 3, 3, 3),
Bergsfjord = c(0, 0, 0, 6, 0, 8, 6, 0, 6, 6)
)
over
over <- data.frame(
Year = c(2018, 2019, 2019, 2020, 2020, 2021, 2021, 2021, 2022, 2022),
Time = c("October", "May", "Oct", "June", "October", "March", "June", "October", "March", "September"),
Balsfjord = c(4, 4, 4, 3, 4, 10, 5, 4, 7, 0),
Frakfjord = c(0, 0, 0, 3, 0, 4, 3, 4, 4, 4),
Olderfjord = c(0, 0, 0, 1, 0, 3, 1, 3, 3, 3),
Bergsfjord = c(0, 0, 0, 6, 0, 8, 6, 0, 6, 6)
)
over
mm %>% filter(Filter_name %in% l)	%>%
distinct(Cruise_no,Station_name)
mm %>% distinct(Cruise_no)
mm %>% distinct(Cruise_no,$Date)
mm %>% distinct(Cruise_no,Date)
View(mm)
over
View(mm)
mm %>% distinct(Cruise_no,Date) %>% arrange(Cruise_no)
mm %>% distinct(Cruise_no,Date) %>% arrange(Date)
mm %>% distinct(Cruise_no,Date) %>% arrange(Cruise_no)
over <- data.frame(
Year = c(2018, 2019, 2019, 2020, 2020, 2021, 2021, 2021, 2022, 2022),
Time = c("October", "May", "Oct", "June", "October", "March", "June", "October", "March", "September"),
Cruise = c(2018625, 2019631, 2019629, 2020611, 2020620, 2021607, 2021614, 2021512, 2022607, 2022624),
Balsfjord = c(4, 4, 4, 3, 4, 10, 5, 4, 7, 0),
Frakfjord = c(0, 0, 0, 3, 0, 4, 3, 4, 4, 4),
Olderfjord = c(0, 0, 0, 1, 0, 3, 1, 3, 3, 3),
Bergsfjord = c(0, 0, 0, 6, 0, 8, 6, 0, 6, 6)
)
over
over %>% pull(Cruise)
over$Cruise
mm %>% distinct(Cruise_no)
mm %>% distinct(Cruise_no) %>% pull(Cruise_no)
mm %>% distinct(Cruise_no) %>% pull(Cruise_no)
l <- mm %>% distinct(Cruise_no) %>% pull(Cruise_no)
ll <- over$Cruise
l%in%ll
l
l[l%in%ll]
l[l%notin%ll]
View(mm)
over
over <- data.frame(
Year = c(2018, 2019, 2019, 2020, 2020, 2021, 2021, 2021, 2022, 2022),
Time = c("October", "May", "Oct", "June", "October", "March", "June", "October", "March", "September"),
Cruise_1 = c("2018625", "2019631", "2019629", "2020611", "2020620", "2021607", "2021614", "2021512", "2022607", "2022624"),
Cruise_2 = c("", "", "", "", "", "", "", "2021624", "", ""),
Balsfjord = c(4, 4, 4, 3, 4, 10, 5, 4, 7, 0),
Frakfjord = c(0, 0, 0, 3, 0, 4, 3, 4, 4, 4),
Olderfjord = c(0, 0, 0, 1, 0, 3, 1, 3, 3, 3),
Bergsfjord = c(0, 0, 0, 6, 0, 8, 6, 0, 6, 6)
)
over
over <- data.frame(
Year = c(2018, 2019, 2019, 2020, 2020, 2021, 2021, 2021, 2022, 2022),
Time = c("October", "May", "Oct", "June", "October", "March", "June", "October", "March", "September"),
Cruise_1 = c("2018625", "2019631", "2019629", "2020611", "2020620", "2021607", "2021614", "2021624", "2022607", "2022624"),
Cruise_2 = c("", "", "", "", "", "", "", "2021512", "", ""),
Balsfjord = c(4, 4, 4, 3, 4, 10, 5, 4, 7, 0),
Frakfjord = c(0, 0, 0, 3, 0, 4, 3, 4, 4, 4),
Olderfjord = c(0, 0, 0, 1, 0, 3, 1, 3, 3, 3),
Bergsfjord = c(0, 0, 0, 6, 0, 8, 6, 0, 6, 6)
)
over
mm <- read.csv("/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Documents & Protocolls/ALL_FISHDIV_samples_metadata_curated.csv")
noo <- c("id","rank","scientific_name","best_identity","superkingdom_name","kingdom_name","phylum_name","class_name","order_name","family_name","genus_name","species_name","best_match","species_list","taxid","seq_length","cluster_weight","total_reads","sequence")
mm <- mm %>% mutate(Filter_name=if_else(!is.na(Running_no),paste0("X",Filter_name),Filter_name))
mm
l <- nenf %>% select(-noo) %>% colnames()
mm %>% filter(Filter_name %in% l)	%>%
distinct(Cruise_no,Station_name)
mm %>% filter(Filter_name %in% l)	%>%
distinct(Cruise_no,sample_type)
mm
mm %>% filter(Filter_name %in% l)	%>%
distinct(Cruise_no,sample_type)
nenf
nenf <- read.csv("/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Data/Bioinformatics/Plate_NENF/Plate_NE_All_MOTUs_collapsed.csv")
write.csv("/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Data/eDNA/Paper III/Plane_NENF_collapsed")
write.csv(nenf,"/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Data/eDNA/Paper III/Plane_NENF_collapsed")
setwd("/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Data/eDNA/Paper III")
nenf <- read.csv("/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Data/Bioinformatics/Plate_NENF/Plate_NE_All_MOTUs_collapsed.csv")
setwd("/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Data/eDNA/Paper III")
write.csv(nenf,"/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Data/eDNA/Paper III/Plane_NENF_collapsed.csv")
nenf2 <- read.csv("Plane_NENF_collapsed.csv")
View(nenf2)
nenf2 <- read.csv("Plane_NENF_collapsed.csv",row.names = F)
write.csv(nenf,"/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Data/eDNA/Paper III/Plane_NENF_collapsed.csv",row.names = F)
nenf2 <- read.csv("Plane_NENF_collapsed.csv")
View(nenf2)
nenf
# nenf <- read.csv("/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Data/Bioinformatics/Plate_NENF/Plate_NE_All_MOTUs_collapsed.csv")
# write.csv(nenf,"/Users/a36142/Library/CloudStorage/OneDrive-Havforskningsinstituttet/IMR/Data/eDNA/Paper III/Plane_NENF_collapsed.csv",row.names = F)
nenf <- read.csv("Plane_NENF_collapsed.csv")
rm(nenf2)
View(table_data)
rm(table_data)
